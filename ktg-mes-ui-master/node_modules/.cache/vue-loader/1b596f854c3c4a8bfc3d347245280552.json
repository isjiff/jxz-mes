{"remainingRequest":"D:\\resource\\eclipse-workspace\\ktg-mes-master\\ktg-mes-ui-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\resource\\eclipse-workspace\\ktg-mes-master\\ktg-mes-ui-master\\src\\views\\mes\\cal\\plan\\team.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\resource\\eclipse-workspace\\ktg-mes-master\\ktg-mes-ui-master\\src\\views\\mes\\cal\\plan\\team.vue","mtime":1662109326000},{"path":"D:\\resource\\eclipse-workspace\\ktg-mes-master\\ktg-mes-ui-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1662432868786},{"path":"D:\\resource\\eclipse-workspace\\ktg-mes-master\\ktg-mes-ui-master\\node_modules\\babel-loader\\lib\\index.js","mtime":1662432871518},{"path":"D:\\resource\\eclipse-workspace\\ktg-mes-master\\ktg-mes-ui-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1662432868786},{"path":"D:\\resource\\eclipse-workspace\\ktg-mes-master\\ktg-mes-ui-master\\node_modules\\vue-loader\\lib\\index.js","mtime":1662432874590}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGxpc3RQbGFudGVhbSwgIGRlbFBsYW50ZWFtLCBhZGRQbGFudGVhbSB9IGZyb20gIkAvYXBpL21lcy9jYWwvcGxhbnRlYW0iOwppbXBvcnQgeyBsaXN0VGVhbW1lbWJlciB9IGZyb20gIkAvYXBpL21lcy9jYWwvdGVhbW1lbWJlciI7CmltcG9ydCBUZWFtU2VsZWN0IGZyb20gIkAvY29tcG9uZW50cy9jYWxUZWFtU2VsZWN0L211bHRpLnZ1ZSIKZXhwb3J0IGRlZmF1bHQgewogICAgbmFtZToiUGxhblRlYW0iLAogICAgY29tcG9uZW50czp7VGVhbVNlbGVjdH0sCiAgICBwcm9wczp7CiAgICAgICAgcGxhbklkOm51bGwsCiAgICAgICAgb3B0VHlwZTpudWxsLAogICAgICAgIGNhbGVuZGFyVHlwZTpudWxsCiAgICB9LAogICAgZGF0YSgpewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIC8vIOmBrue9qeWxggogICAgICAgICAgICBsb2FkaW5nOiB0cnVlLAogICAgICAgICAgICAvL+ePree7hOihqOagvOaVsOaNrgogICAgICAgICAgICB0ZWFtTGlzdDpbXSwKICAgICAgICAgICAgLy8g54+t57uE5oiQ5ZGY6KGo5qC85pWw5o2uCiAgICAgICAgICAgIHRlYW1tZW1iZXJMaXN0OiBbXSwKICAgICAgICAgICAgZm9ybTp7fSwKICAgICAgICAgICAgcXVlcnlQYXJhbXM6IHsKICAgICAgICAgICAgICAgIHBhZ2VOdW06IDEsCiAgICAgICAgICAgICAgICBwYWdlU2l6ZTogMTAsCiAgICAgICAgICAgICAgICBwbGFuSWQ6IHRoaXMucGxhbklkLAogICAgICAgICAgICAgICAgdGVhbUlkOiBudWxsLAogICAgICAgICAgICAgICAgdGVhbUNvZGU6IG51bGwsCiAgICAgICAgICAgICAgICB0ZWFtTmFtZTogbnVsbCwKICAgICAgICAgICAgICAgIGNhbGVuZGFyVHlwZTp0aGlzLmNhbGVuZGFyVHlwZQogICAgICAgICAgICB9LAogICAgICAgIH0KICAgIH0sCiAgICBjcmVhdGVkKCkgewogICAgICAgIHRoaXMuZ2V0VGVhbUxpc3QoKTsgICAgIAogICAgfSwKICAgIG1ldGhvZHM6ewogICAgICAgIGdldFRlYW1MaXN0KCl7CiAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7CiAgICAgICAgICAgIGxpc3RQbGFudGVhbSh0aGlzLnF1ZXJ5UGFyYW1zKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAgICAgICAgIHRoaXMudGVhbUxpc3QgPSByZXNwb25zZS5yb3dzOyAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICB9KTsKICAgICAgICB9LAogICAgICAgIGdldE1lbWJlckxpc3QoaWQpewogICAgICAgICAgICB2YXIgcGFyYW0gPSB7CiAgICAgICAgICAgICAgICB0ZWFtSWQ6aWQKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlOwogICAgICAgICAgICBsaXN0VGVhbW1lbWJlcihwYXJhbSkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLnRlYW1tZW1iZXJMaXN0ID0gcmVzcG9uc2Uucm93czsKICAgICAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICB9KTsKICAgICAgICB9LAogICAgICAgIG9uUm93Q2xpY2socm93KXsKICAgICAgICAgICAgdGhpcy5nZXRNZW1iZXJMaXN0KHJvdy50ZWFtSWQpOwogICAgICAgIH0sCiAgICAgICAgLyoqIOaWsOWinuaMiemSruaTjeS9nCAqLwogICAgICAgIGhhbmRsZUFkZCgpIHsKICAgICAgICAgICAgdGhpcy4kcmVmcy50ZWFtU2VsZWN0LnNob3dGbGFnID0gdHJ1ZTsKICAgICAgICB9LAogICAgICAgIG9uVGVhbVNlbGVjdGVkKHJvd3MpewogICAgICAgICAgICByb3dzLmZvckVhY2godGVhbSA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLmZvcm0udGVhbUlkID0gdGVhbS50ZWFtSWQ7CiAgICAgICAgICAgICAgICB0aGlzLmZvcm0udGVhbUNvZGUgPSB0ZWFtLnRlYW1Db2RlOwogICAgICAgICAgICAgICAgdGhpcy5mb3JtLnRlYW1OYW1lID0gdGVhbS50ZWFtTmFtZTsKICAgICAgICAgICAgICAgIHRoaXMuZm9ybS5wbGFuSWQgPSB0aGlzLnBsYW5JZDsKICAgICAgICAgICAgICAgIHRoaXMuZm9ybS5jYWxlbmRhclR5cGUgPSB0aGlzLmNhbGVuZGFyVHlwZTsKICAgICAgICAgICAgICAgIGFkZFBsYW50ZWFtKHRoaXMuZm9ybSkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRUZWFtTGlzdCgpOyAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgICAvKiog5Yig6Zmk5oyJ6ZKu5pON5L2cICovCiAgICAgICAgaGFuZGxlRGVsZXRlKHJvdykgewogICAgICAgICAgICBjb25zdCByZWNvcmRJZHMgPSByb3cucmVjb3JkSWQKICAgICAgICAgICAgdGhpcy4kbW9kYWwuY29uZmlybSgn5piv5ZCm56Gu6K6k5Yig6Zmk54+t57uE77yfJykudGhlbihmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIHJldHVybiBkZWxQbGFudGVhbShyZWNvcmRJZHMpOwogICAgICAgICAgICB9KS50aGVuKCgpID0+IHsKICAgICAgICAgICAgICAgIHRoaXMuZ2V0VGVhbUxpc3QoKTsKICAgICAgICAgICAgICAgIHRoaXMuJG1vZGFsLm1zZ1N1Y2Nlc3MoIuWIoOmZpOaIkOWKnyIpOwogICAgICAgICAgICB9KS5jYXRjaCgoKSA9PiB7fSk7CiAgICAgICAgfSwKICAgIH0KfQo="},{"version":3,"sources":["team.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"team.vue","sourceRoot":"src/views/mes/cal/plan","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <el-row>\n        <el-col :span=\"12\">\n            <el-card class=\"box-card\">\n                <div slot=\"header\" class=\"clearfix\">\n                    <span>班组</span>\n                    <el-button style=\"float: right; padding: 3px 0\" v-if=\"optType !='view'\" @click=\"handleAdd\" type=\"text\">添加</el-button>\n                </div>\n                <el-table v-loading=\"loading\" :data=\"teamList\" @row-click=\"onRowClick\">\n                    <el-table-column label=\"班组编号\" align=\"center\" prop=\"teamCode\" >\n                    </el-table-column>\n                    <el-table-column label=\"班组名称\" align=\"center\" prop=\"teamName\" />\n                    <el-table-column label=\"操作\" align=\"center\" v-if=\"optType !='view'\" class-name=\"small-padding fixed-width\">\n                        <template slot-scope=\"scope\">\n                        <el-button\n                            size=\"mini\"\n                            type=\"text\"\n                            icon=\"el-icon-delete\"\n                            @click=\"handleDelete(scope.row)\"\n                            v-hasPermi=\"['mes:cal:plan:edit']\"\n                        >删除</el-button>\n                        </template>\n                    </el-table-column>                    \n                </el-table>           \n                <TeamSelect ref=\"teamSelect\" @onSelected=\"onTeamSelected\"></TeamSelect>    \n            </el-card>\n        </el-col>\n        <el-col :span=\"12\">\n            <el-card class=\"box-card\">\n                <div slot=\"header\" class=\"clearfix\">\n                    <span>成员</span>                    \n                </div>\n                <el-table v-loading=\"loading\" :data=\"teammemberList\">\n                    <el-table-column label=\"用户名\" align=\"center\" prop=\"userName\" />\n                    <el-table-column label=\"用户昵称\" align=\"center\" prop=\"nickName\" />\n                    <el-table-column label=\"电话\" align=\"center\" prop=\"tel\" />                    \n                </el-table>\n            </el-card>\n        </el-col>\n    </el-row>\n  </div>\n</template>\n\n<script>\nimport { listPlanteam,  delPlanteam, addPlanteam } from \"@/api/mes/cal/planteam\";\nimport { listTeammember } from \"@/api/mes/cal/teammember\";\nimport TeamSelect from \"@/components/calTeamSelect/multi.vue\"\nexport default {\n    name:\"PlanTeam\",\n    components:{TeamSelect},\n    props:{\n        planId:null,\n        optType:null,\n        calendarType:null\n    },\n    data(){\n        return {\n            // 遮罩层\n            loading: true,\n            //班组表格数据\n            teamList:[],\n            // 班组成员表格数据\n            teammemberList: [],\n            form:{},\n            queryParams: {\n                pageNum: 1,\n                pageSize: 10,\n                planId: this.planId,\n                teamId: null,\n                teamCode: null,\n                teamName: null,\n                calendarType:this.calendarType\n            },\n        }\n    },\n    created() {\n        this.getTeamList();     \n    },\n    methods:{\n        getTeamList(){\n            this.loading = true;\n            listPlanteam(this.queryParams).then(response => {\n                this.teamList = response.rows;                \n                this.loading = false;\n            });\n        },\n        getMemberList(id){\n            var param = {\n                teamId:id\n            }\n            this.loading = true;\n            listTeammember(param).then(response => {\n                this.teammemberList = response.rows;\n                this.loading = false;\n            });\n        },\n        onRowClick(row){\n            this.getMemberList(row.teamId);\n        },\n        /** 新增按钮操作 */\n        handleAdd() {\n            this.$refs.teamSelect.showFlag = true;\n        },\n        onTeamSelected(rows){\n            rows.forEach(team => {\n                this.form.teamId = team.teamId;\n                this.form.teamCode = team.teamCode;\n                this.form.teamName = team.teamName;\n                this.form.planId = this.planId;\n                this.form.calendarType = this.calendarType;\n                addPlanteam(this.form).then(response => {\n                    this.getTeamList();                    \n                });\n            });\n        },\n        /** 删除按钮操作 */\n        handleDelete(row) {\n            const recordIds = row.recordId\n            this.$modal.confirm('是否确认删除班组？').then(function() {\n                return delPlanteam(recordIds);\n            }).then(() => {\n                this.getTeamList();\n                this.$modal.msgSuccess(\"删除成功\");\n            }).catch(() => {});\n        },\n    }\n}\n</script>\n\n<style>\n\n</style>"]}]}