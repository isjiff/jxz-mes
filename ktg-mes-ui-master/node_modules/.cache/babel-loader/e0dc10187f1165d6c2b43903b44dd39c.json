{"remainingRequest":"D:\\resource\\eclipse-workspace\\ktg-mes-master\\ktg-mes-ui-master\\node_modules\\babel-loader\\lib\\index.js!D:\\resource\\eclipse-workspace\\ktg-mes-master\\ktg-mes-ui-master\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\resource\\eclipse-workspace\\ktg-mes-master\\ktg-mes-ui-master\\src\\store\\modules\\user.js","dependencies":[{"path":"D:\\resource\\eclipse-workspace\\ktg-mes-master\\ktg-mes-ui-master\\src\\store\\modules\\user.js","mtime":1662109326000},{"path":"D:\\resource\\eclipse-workspace\\ktg-mes-master\\ktg-mes-ui-master\\babel.config.js","mtime":1662109326000},{"path":"D:\\resource\\eclipse-workspace\\ktg-mes-master\\ktg-mes-ui-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1662432868786},{"path":"D:\\resource\\eclipse-workspace\\ktg-mes-master\\ktg-mes-ui-master\\node_modules\\babel-loader\\lib\\index.js","mtime":1662432871518},{"path":"D:\\resource\\eclipse-workspace\\ktg-mes-master\\ktg-mes-ui-master\\node_modules\\eslint-loader\\index.js","mtime":1662432869370}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy50cmltLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCB7IGxvZ2luLCBsb2dvdXQsIGdldEluZm8gfSBmcm9tICdAL2FwaS9sb2dpbic7CmltcG9ydCB7IGdldFRva2VuLCBzZXRUb2tlbiwgcmVtb3ZlVG9rZW4gfSBmcm9tICdAL3V0aWxzL2F1dGgnOwp2YXIgdXNlciA9IHsKICBzdGF0ZTogewogICAgdG9rZW46IGdldFRva2VuKCksCiAgICBuYW1lOiAnJywKICAgIGF2YXRhcjogJycsCiAgICByb2xlczogW10sCiAgICBwZXJtaXNzaW9uczogW10KICB9LAogIG11dGF0aW9uczogewogICAgU0VUX1RPS0VOOiBmdW5jdGlvbiBTRVRfVE9LRU4oc3RhdGUsIHRva2VuKSB7CiAgICAgIHN0YXRlLnRva2VuID0gdG9rZW47CiAgICB9LAogICAgU0VUX05BTUU6IGZ1bmN0aW9uIFNFVF9OQU1FKHN0YXRlLCBuYW1lKSB7CiAgICAgIHN0YXRlLm5hbWUgPSBuYW1lOwogICAgfSwKICAgIFNFVF9BVkFUQVI6IGZ1bmN0aW9uIFNFVF9BVkFUQVIoc3RhdGUsIGF2YXRhcikgewogICAgICBzdGF0ZS5hdmF0YXIgPSBhdmF0YXI7CiAgICB9LAogICAgU0VUX1JPTEVTOiBmdW5jdGlvbiBTRVRfUk9MRVMoc3RhdGUsIHJvbGVzKSB7CiAgICAgIHN0YXRlLnJvbGVzID0gcm9sZXM7CiAgICB9LAogICAgU0VUX1BFUk1JU1NJT05TOiBmdW5jdGlvbiBTRVRfUEVSTUlTU0lPTlMoc3RhdGUsIHBlcm1pc3Npb25zKSB7CiAgICAgIHN0YXRlLnBlcm1pc3Npb25zID0gcGVybWlzc2lvbnM7CiAgICB9CiAgfSwKICBhY3Rpb25zOiB7CiAgICAvLyDnmbvlvZUKICAgIExvZ2luOiBmdW5jdGlvbiBMb2dpbihfcmVmLCB1c2VySW5mbykgewogICAgICB2YXIgY29tbWl0ID0gX3JlZi5jb21taXQ7CiAgICAgIHZhciB1c2VybmFtZSA9IHVzZXJJbmZvLnVzZXJuYW1lLnRyaW0oKTsKICAgICAgdmFyIHBhc3N3b3JkID0gdXNlckluZm8ucGFzc3dvcmQ7CiAgICAgIHZhciBjb2RlID0gdXNlckluZm8uY29kZTsKICAgICAgdmFyIHV1aWQgPSB1c2VySW5mby51dWlkOwogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIGxvZ2luKHVzZXJuYW1lLCBwYXNzd29yZCwgY29kZSwgdXVpZCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICBzZXRUb2tlbihyZXMudG9rZW4pOwogICAgICAgICAgY29tbWl0KCdTRVRfVE9LRU4nLCByZXMudG9rZW4pOwogICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgICAgcmVqZWN0KGVycm9yKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgLy8g6I635Y+W55So5oi35L+h5oGvCiAgICBHZXRJbmZvOiBmdW5jdGlvbiBHZXRJbmZvKF9yZWYyKSB7CiAgICAgIHZhciBjb21taXQgPSBfcmVmMi5jb21taXQsCiAgICAgICAgICBzdGF0ZSA9IF9yZWYyLnN0YXRlOwogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIGdldEluZm8oKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgIHZhciB1c2VyID0gcmVzLnVzZXI7CiAgICAgICAgICB2YXIgYXZhdGFyID0gdXNlci5hdmF0YXIgPT0gIiIgfHwgdXNlci5hdmF0YXIgPT0gbnVsbCA/IHJlcXVpcmUoIkAvYXNzZXRzL2ltYWdlcy9wcm9maWxlLmpwZyIpIDogcHJvY2Vzcy5lbnYuVlVFX0FQUF9CQVNFX0FQSSArIHVzZXIuYXZhdGFyOwoKICAgICAgICAgIGlmIChyZXMucm9sZXMgJiYgcmVzLnJvbGVzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgLy8g6aqM6K+B6L+U5Zue55qEcm9sZXPmmK/lkKbmmK/kuIDkuKrpnZ7nqbrmlbDnu4QKICAgICAgICAgICAgY29tbWl0KCdTRVRfUk9MRVMnLCByZXMucm9sZXMpOwogICAgICAgICAgICBjb21taXQoJ1NFVF9QRVJNSVNTSU9OUycsIHJlcy5wZXJtaXNzaW9ucyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb21taXQoJ1NFVF9ST0xFUycsIFsnUk9MRV9ERUZBVUxUJ10pOwogICAgICAgICAgfQoKICAgICAgICAgIGNvbW1pdCgnU0VUX05BTUUnLCB1c2VyLnVzZXJOYW1lKTsKICAgICAgICAgIGNvbW1pdCgnU0VUX0FWQVRBUicsIGF2YXRhcik7CiAgICAgICAgICByZXNvbHZlKHJlcyk7CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICByZWplY3QoZXJyb3IpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICAvLyDpgIDlh7rns7vnu58KICAgIExvZ091dDogZnVuY3Rpb24gTG9nT3V0KF9yZWYzKSB7CiAgICAgIHZhciBjb21taXQgPSBfcmVmMy5jb21taXQsCiAgICAgICAgICBzdGF0ZSA9IF9yZWYzLnN0YXRlOwogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIGxvZ291dChzdGF0ZS50b2tlbikudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICBjb21taXQoJ1NFVF9UT0tFTicsICcnKTsKICAgICAgICAgIGNvbW1pdCgnU0VUX1JPTEVTJywgW10pOwogICAgICAgICAgY29tbWl0KCdTRVRfUEVSTUlTU0lPTlMnLCBbXSk7CiAgICAgICAgICByZW1vdmVUb2tlbigpOwogICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgICAgcmVqZWN0KGVycm9yKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgLy8g5YmN56uvIOeZu+WHugogICAgRmVkTG9nT3V0OiBmdW5jdGlvbiBGZWRMb2dPdXQoX3JlZjQpIHsKICAgICAgdmFyIGNvbW1pdCA9IF9yZWY0LmNvbW1pdDsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgICAgY29tbWl0KCdTRVRfVE9LRU4nLCAnJyk7CiAgICAgICAgcmVtb3ZlVG9rZW4oKTsKICAgICAgICByZXNvbHZlKCk7CiAgICAgIH0pOwogICAgfQogIH0KfTsKZXhwb3J0IGRlZmF1bHQgdXNlcjs="},{"version":3,"names":["login","logout","getInfo","getToken","setToken","removeToken","user","state","token","name","avatar","roles","permissions","mutations","SET_TOKEN","SET_NAME","SET_AVATAR","SET_ROLES","SET_PERMISSIONS","actions","Login","userInfo","commit","username","trim","password","code","uuid","Promise","resolve","reject","then","res","catch","error","GetInfo","require","process","env","VUE_APP_BASE_API","length","userName","LogOut","FedLogOut"],"sources":["D:/resource/eclipse-workspace/ktg-mes-master/ktg-mes-ui-master/src/store/modules/user.js"],"sourcesContent":["import { login, logout, getInfo } from '@/api/login'\nimport { getToken, setToken, removeToken } from '@/utils/auth'\n\nconst user = {\n  state: {\n    token: getToken(),\n    name: '',\n    avatar: '',\n    roles: [],\n    permissions: []\n  },\n\n  mutations: {\n    SET_TOKEN: (state, token) => {\n      state.token = token\n    },\n    SET_NAME: (state, name) => {\n      state.name = name\n    },\n    SET_AVATAR: (state, avatar) => {\n      state.avatar = avatar\n    },\n    SET_ROLES: (state, roles) => {\n      state.roles = roles\n    },\n    SET_PERMISSIONS: (state, permissions) => {\n      state.permissions = permissions\n    }\n  },\n\n  actions: {\n    // 登录\n    Login({ commit }, userInfo) {\n      const username = userInfo.username.trim()\n      const password = userInfo.password\n      const code = userInfo.code\n      const uuid = userInfo.uuid\n      return new Promise((resolve, reject) => {\n        login(username, password, code, uuid).then(res => {\n          setToken(res.token)\n          commit('SET_TOKEN', res.token)\n          resolve()\n        }).catch(error => {\n          reject(error)\n        })\n      })\n    },\n\n    // 获取用户信息\n    GetInfo({ commit, state }) {\n      return new Promise((resolve, reject) => {\n        getInfo().then(res => {\n          const user = res.user\n          const avatar = (user.avatar == \"\" || user.avatar == null) ? require(\"@/assets/images/profile.jpg\") : process.env.VUE_APP_BASE_API + user.avatar;\n          if (res.roles && res.roles.length > 0) { // 验证返回的roles是否是一个非空数组\n            commit('SET_ROLES', res.roles)\n            commit('SET_PERMISSIONS', res.permissions)\n          } else {\n            commit('SET_ROLES', ['ROLE_DEFAULT'])\n          }\n          commit('SET_NAME', user.userName)\n          commit('SET_AVATAR', avatar)\n          resolve(res)\n        }).catch(error => {\n          reject(error)\n        })\n      })\n    },\n\n    // 退出系统\n    LogOut({ commit, state }) {\n      return new Promise((resolve, reject) => {\n        logout(state.token).then(() => {\n          commit('SET_TOKEN', '')\n          commit('SET_ROLES', [])\n          commit('SET_PERMISSIONS', [])\n          removeToken()\n          resolve()\n        }).catch(error => {\n          reject(error)\n        })\n      })\n    },\n\n    // 前端 登出\n    FedLogOut({ commit }) {\n      return new Promise(resolve => {\n        commit('SET_TOKEN', '')\n        removeToken()\n        resolve()\n      })\n    }\n  }\n}\n\nexport default user\n"],"mappings":"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"}]}